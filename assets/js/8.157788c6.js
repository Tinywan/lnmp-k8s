(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{174:function(a,t,s){"use strict";s.r(t);var e=s(0),r=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"efk-插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#efk-插件","aria-hidden":"true"}},[a._v("#")]),a._v(" EFK 插件")]),a._v(" "),s("h2",{attrs:{id:"注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意事项","aria-hidden":"true"}},[a._v("#")]),a._v(" 注意事项")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("推荐宿主机内存 16G")])]),a._v(" "),s("li",[s("p",[a._v("虚拟机每个节点内存分配 3G，之前分配了 2G 一直报错")])]),a._v(" "),s("li",[s("p",[a._v("es-statefulset.yaml 的 replicas 参数 "),s("strong",[a._v("不能")]),a._v(" 为 1 "),s("strong",[a._v("故单集群不能用")])])])]),a._v(" "),s("h2",{attrs:{id:"资源占用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#资源占用","aria-hidden":"true"}},[a._v("#")]),a._v(" 资源占用")]),a._v(" "),s("p",[s("code",[a._v("elasticsearch-logging-N")]),a._v(" 单个 pod 内存占用 1.5 G。")]),a._v(" "),s("h2",{attrs:{id:"基础知识"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基础知识","aria-hidden":"true"}},[a._v("#")]),a._v(" 基础知识")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("elasticsearch 负责存储日志。")])]),a._v(" "),s("li",[s("p",[a._v("fluentd 负责将集群中 docker 主机上的日志发送给 elasticsearch，因此 fluentd 在 k8s 集群中需要以 daemonset 的方式运行。")])]),a._v(" "),s("li",[s("p",[a._v("kibana 负责图形化展示日志信息。")])])]),a._v(" "),s("h2",{attrs:{id:"部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署","aria-hidden":"true"}},[a._v("#")]),a._v(" 部署")]),a._v(" "),s("ul",[s("li",[a._v("https://github.com/kubernetes/kubernetes/tree/master/cluster/addons/fluentd-elasticsearch")])]),a._v(" "),s("h3",{attrs:{id:"部署-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署-2","aria-hidden":"true"}},[a._v("#")]),a._v(" 部署")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ kubectl apply -k addons/efk\n\n$ kubectl get pods -n kube-system -o wide"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" -E "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'elasticsearch|fluentd|kibana'")]),a._v("\n\n$ kubectl cluster-info"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" -E "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Elasticsearch|Kibana'")]),a._v("\n\n$ kubectl proxy --address"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'192.168.57.1'")]),a._v(" --port"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("8086 --accept-hosts"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'^*$'")]),a._v("\n")])])]),s("p",[a._v("http://192.168.57.1:8086/api/v1/namespaces/kube-system/services/kibana-logging/proxy")]),a._v(" "),s("h2",{attrs:{id:"删除"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除","aria-hidden":"true"}},[a._v("#")]),a._v(" 删除")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ kubectl delete -k addons/efk\n")])])]),s("h2",{attrs:{id:"资源列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#资源列表","aria-hidden":"true"}},[a._v("#")]),a._v(" 资源列表")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("service/elasticsearch-logging\n\nservice/kibana-logging\n\ndaemonset.apps/fluentd\n")])])]),s("h2",{attrs:{id:"more-information"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#more-information","aria-hidden":"true"}},[a._v("#")]),a._v(" More Information")]),a._v(" "),s("ul",[s("li",[a._v("http://blog.51cto.com/ylw6006/2071943")]),a._v(" "),s("li",[a._v("https://www.jianshu.com/p/1000ae80a493")]),a._v(" "),s("li",[a._v("https://blog.csdn.net/java_zyq/article/details/82179175")])])])}],!1,null,null,null);t.default=r.exports}}]);