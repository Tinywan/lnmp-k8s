(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{207:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),e("ul",[t._m(1),t._v(" "),t._m(2),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://github.com/opencontainers/runc",target:"_blank",rel:"noopener noreferrer"}},[t._v("runc"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://github.com/containers/crun",target:"_blank",rel:"noopener noreferrer"}},[t._v("crun"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://github.com/google/gvisor",target:"_blank",rel:"noopener noreferrer"}},[t._v("runsc"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://github.com/kata-containers/runtime",target:"_blank",rel:"noopener noreferrer"}},[t._v("kata-containers"),e("OutboundLink")],1)])])]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._m(14),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),e("p",[t._v("配置 Docker")]),t._v(" "),t._m(27),t._v(" "),t._m(28),e("p",[t._v("在 Docker 中使用")]),t._v(" "),t._m(29),t._m(30),t._v(" "),e("p",[t._v("安装 kvm")]),t._v(" "),t._m(31)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"oci-runtime"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#oci-runtime","aria-hidden":"true"}},[this._v("#")]),this._v(" OCI Runtime")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("https://kubernetes.io/docs/concepts/containers/runtime-class/")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("https://github.com/opencontainers/runtime-spec/blob/master/implementations.md")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"runc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#runc","aria-hidden":"true"}},[this._v("#")]),this._v(" runc")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://github.com/opencontainers/runc")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"gvisor-runsc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gvisor-runsc","aria-hidden":"true"}},[this._v("#")]),this._v(" gvisor(runsc)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://github.com/google/gvisor")]),this._v(" "),s("li",[this._v("https://gvisor.dev/docs/user_guide/docker/")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"在-kubernetes-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在-kubernetes-使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 在 Kubernetes 使用")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"containerd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#containerd","aria-hidden":"true"}},[this._v("#")]),this._v(" Containerd")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://github.com/google/gvisor-containerd-shim")]),this._v(" "),s("li",[this._v("https://github.com/google/gvisor-containerd-shim/blob/master/docs/runtime-handler-shim-v2-quickstart.md")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下载 "),s("code",[this._v("containerd-shim-runsc-v1")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -fsSL -o /usr/local/bin/containerd-shim-runsc-v1 https://github.com/google/gvisor-containerd-shim/releases/download/v0.0.3/containerd-shim-runsc-v1.linux-amd64\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" +x /usr/local/bin/containerd-shim-runsc-v1\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("/etc/containerd/config.toml")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-toml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-toml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [plugins.cri.containerd.runtimes.${HANDLER_NAME}]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("plugins.cri.containerd.runtimes.runsc")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("runtime_type")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"io.containerd.runsc.v1"')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" systemctl restart containerd\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"cri-o"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cri-o","aria-hidden":"true"}},[this._v("#")]),this._v(" cri-o")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("/etc/crio/crio.conf")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-toml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-toml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [crio.runtime.runtimes.${HANDLER_NAME}]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("crio.runtime.runtimes.runsc")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#  runtime_path = "${PATH_TO_BINARY}"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("runtime_path")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/usr/local/bin/runsc"')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("新建 "),s("code",[this._v("runtimeclass")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node.k8s.io/v1beta1  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# RuntimeClass is defined in the node.k8s.io API group")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" RuntimeClass\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" myclass  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The name the RuntimeClass will be referenced by")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# RuntimeClass is a non-namespaced resource")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# handler: myconfiguration  # The name of the corresponding CRI configuration")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" runsc "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 值与 CRI 配置文件对应 ${HANDLER_NAME}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用 "),s("code",[this._v("runtimeclass")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Pod\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mypod\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 与 runtimeclass 配置文件的 metadata.name 对应")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runtimeClassName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" myclass\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"在-docker-中使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在-docker-中使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 在 Docker 中使用")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("code",[t._v("runsc")]),t._v(" 与 "),e("code",[t._v("Docker")]),t._v(" 的 "),e("code",[t._v("--exec-opt native.cgroupdriver=systemd")]),t._v(" 不兼容。")]),t._v(" "),e("li",[t._v("https://github.com/google/gvisor/issues/193")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下载 "),s("code",[this._v("runsc")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -fsSL https://github.com/docker-practice/gvisor-mirror/releases/download/nightly/runsc-linux-amd64.tar.gz "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -C /usr/local/bin -zxvf -\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /usr/local/bin/runsc\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" +x /usr/local/bin/runsc\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("/etc/docker/daemon.json")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"runtimes"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"runsc"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/usr/local/bin/runsc"')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"runsc-kvm"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/usr/local/bin/runsc"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"runtimeArgs"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--platform=kvm"')]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ docker run --runtime"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("runsc --rm hello-world\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[this._v("#")]),this._v(" 参考")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("apt-get")]),this._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" qemu-kvm\n")])])])}],!1,null,null,null);s.default=n.exports}}]);